name: JSON Backup

on:
  schedule:
    - cron: '0 */4 * * *'
  workflow_dispatch:

jobs:
  backup:
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Download JSON
        run: |
          URL="https://publish-01.obsidian.md/cache/39a393bd37490e3597370f63f89358a6"
          
          # ä¸‹è½½å¹¶éªŒè¯
          curl -s -L -o abhidharma.json "$URL"
          
          if ! jq empty abhidharma.json 2>/dev/null; then
            echo "âŒ Invalid JSON"
            exit 1
          fi
          
          echo "âœ… JSON downloaded"
          echo "size=$(wc -c < abhidharma.json)" >> $GITHUB_OUTPUT
      
      - name: ğŸ“Š Upload as artifact
        uses: actions/upload-artifact@v4
        with:
          name: json-backup
          path: abhidharma.json
